<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Heritage Bank</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #f5f5f5; font-family: 'Segoe UI', sans-serif; }
        
        .dashboard { display: grid; grid-template-columns: 250px 1fr; min-height: 100vh; }
        
        .sidebar { background: #1a472a; color: white; padding: 30px 0; position: sticky; top: 0; height: 100vh; overflow-y: auto; }
        .sidebar-logo { padding: 0 20px 30px; font-size: 1.3rem; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .sidebar-logo img { width: 40px; height: 40px; border-radius: 8px; }
        .sidebar-menu { list-style: none; }
        .sidebar-menu li { padding: 15px 20px; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; }
        .sidebar-menu li:hover, .sidebar-menu li.active { background: rgba(212,175,55,0.2); border-left: 3px solid #d4af37; }
        .sidebar-menu li i { margin-right: 12px; width: 20px; text-align: center; }
        .sidebar-divider { height: 1px; background: rgba(255,255,255,0.1); margin: 15px 20px; }
        .sidebar-section { color: rgba(255,255,255,0.5); font-size: 0.75rem; text-transform: uppercase; padding: 10px 20px; letter-spacing: 1px; }
        
        .main-content { padding: 30px; overflow-y: auto; }
        
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; flex-wrap: wrap; gap: 15px; }
        .header h1 { color: #1a472a; }
        .header-right { display: flex; align-items: center; gap: 15px; }
        
        .notification-btn {
            background: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .notification-btn i { color: #1a472a; }
        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #dc3545;
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logout-btn { background: #d4af37; color: #1a472a; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; }
        .logout-btn:hover { background: #c4a030; }
        
        /* Balance Cards */
        .balance-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        
        .balance-card {
            background: linear-gradient(135deg, #1a472a 0%, #2d5f3f 100%);
            color: white;
            padding: 25px;
            border-radius: 16px;
            position: relative;
            overflow: hidden;
        }
        .balance-card.primary { grid-column: span 2; padding: 35px; }
        .balance-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: rgba(255,255,255,0.05);
            transform: rotate(30deg);
        }
        .balance-card p { opacity: 0.9; font-size: 0.9rem; }
        .balance-card h2 { font-size: 2.5rem; margin: 15px 0; }
        .balance-card.primary h2 { font-size: 3rem; }
        .balance-card .card-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2rem;
            opacity: 0.3;
        }
        
        .balance-card.secondary {
            background: linear-gradient(135deg, #d4af37 0%, #f0d060 100%);
            color: #1a472a;
        }
        
        /* Account Info */
        .account-info {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .account-info h3 { color: #1a472a; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; }
        .info-item { padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .info-item label { display: block; color: #666; font-size: 0.85rem; margin-bottom: 5px; }
        .info-item strong { color: #1a472a; font-size: 1.1rem; }
        .copy-btn {
            background: none;
            border: none;
            color: #d4af37;
            cursor: pointer;
            margin-left: 10px;
        }
        .copy-btn:hover { color: #1a472a; }
        
        /* Quick Actions */
        .section-title { color: #1a472a; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        
        .quick-actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .action-card {
            background: white;
            padding: 25px 15px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .action-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
        .action-card i { font-size: 2rem; color: #d4af37; margin-bottom: 12px; }
        .action-card h4 { color: #1a472a; font-size: 0.95rem; }
        
        /* Transactions */
        .transactions-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .transactions-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .transactions-header h3 { color: #1a472a; display: flex; align-items: center; gap: 10px; }
        .view-all { color: #d4af37; text-decoration: none; font-size: 0.9rem; }
        .view-all:hover { text-decoration: underline; }
        
        .transaction-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            position: relative;
        }
        .transaction-item:last-child { border-bottom: none; }
        .transaction-icon {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
        }
        .transaction-icon.credit { background: #d4edda; color: #28a745; }
        .transaction-icon.debit { background: #f8d7da; color: #dc3545; }
        .transaction-details { flex: 1; }
        .transaction-details h4 { color: #333; font-size: 0.95rem; margin-bottom: 3px; }
        .transaction-details span { color: #666; font-size: 0.85rem; }
        .transaction-amount { font-weight: 600; margin-right: 10px; }
        .btn-receipt {
            padding: 8px 12px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            cursor: pointer;
            color: #666;
            font-size: 14px;
            transition: all 0.3s;
        }
        .btn-receipt:hover {
            background: #e9ecef;
            color: #333;
        }
        .transaction-amount.credit { color: #28a745; }
        .transaction-amount.debit { color: #dc3545; }
        
        .no-transactions {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        .no-transactions i { font-size: 3rem; color: #ddd; margin-bottom: 15px; display: block; }
        
        /* Activity Section */
        .activity-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .activity-item {
            display: flex;
            align-items: flex-start;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        .activity-item:last-child { border-bottom: none; }
        .activity-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #d4af37;
            margin-right: 15px;
            margin-top: 5px;
        }
        .activity-content { flex: 1; }
        .activity-content p { color: #333; margin-bottom: 3px; }
        .activity-content span { color: #666; font-size: 0.85rem; }
        
        /* Mobile sidebar toggle */
        .mobile-toggle {
            display: none;
            background: #1a472a;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
        }
        
        @media (max-width: 900px) {
            .balance-card.primary { grid-column: span 1; }
        }
        
        @media (max-width: 768px) {
            .dashboard { grid-template-columns: 1fr; }
            .sidebar {
                position: fixed;
                left: -250px;
                top: 0;
                z-index: 1000;
                transition: left 0.3s;
            }
            .sidebar.open { left: 0; }
            .mobile-toggle { display: block; }
            .main-content { padding: 20px; }
            .balance-card h2 { font-size: 2rem; }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-logo">
                <img src="assets/logo.png" alt="Heritage Bank" onerror="this.style.display='none'">
                <span>Heritage Bank</span>
            </div>
            <ul class="sidebar-menu">
                <li class="active"><i class="fas fa-home"></i> Dashboard</li>
                <li onclick="location.href='transfer.html'"><i class="fas fa-paper-plane"></i> Transfer</li>
                <li onclick="location.href='pay-bills.html'"><i class="fas fa-file-invoice-dollar"></i> Pay Bills</li>
            </ul>
            <div class="sidebar-divider"></div>
            <div class="sidebar-section">Products</div>
            <ul class="sidebar-menu">
                <li onclick="location.href='cards.html'"><i class="fas fa-credit-card"></i> Cards</li>
                <li onclick="location.href='investment.html'"><i class="fas fa-chart-line"></i> Investments</li>
                <li onclick="location.href='request-loan.html'"><i class="fas fa-hand-holding-usd"></i> Loans</li>
            </ul>
            <div class="sidebar-divider"></div>
            <div class="sidebar-section">Account</div>
            <ul class="sidebar-menu">
                <li onclick="location.href='settings.html'"><i class="fas fa-cog"></i> Settings</li>
                <li onclick="location.href='faq.html'"><i class="fas fa-question-circle"></i> Help & FAQ</li>
            </ul>
        </nav>
        
        <main class="main-content">
            <div class="header">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button class="mobile-toggle" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
                    <div>
                        <p style="color: #666; margin-bottom: 5px;">Welcome back,</p>
                        <h1 id="userName">User</h1>
                    </div>
                </div>
                <div class="header-right">
                    <button class="notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notifBadge">0</span>
                    </button>
                    <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</button>
                </div>
            </div>
            
            <!-- Balance Cards -->
            <div class="balance-cards">
                <div class="balance-card primary">
                    <i class="fas fa-wallet card-icon"></i>
                    <p>Available Balance</p>
                    <h2 id="balance">$0.00</h2>
                    <p id="accountType">Savings Account</p>
                </div>
                <div class="balance-card secondary">
                    <i class="fas fa-piggy-bank card-icon"></i>
                    <p>Savings Goal</p>
                    <h2 id="savingsGoal">$10,000</h2>
                    <p><span id="savingsProgress">0%</span> achieved</p>
                </div>
            </div>
            
            <!-- Account Info -->
            <div class="account-info">
                <h3><i class="fas fa-university"></i> Account Details</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <label>Account Number</label>
                        <strong id="accountNumber">-</strong>
                        <button class="copy-btn" onclick="copyToClipboard('accountNumber')"><i class="fas fa-copy"></i></button>
                    </div>
                    <div class="info-item">
                        <label>Routing Number</label>
                        <strong>091238946</strong>
                        <button class="copy-btn" onclick="copyText('091238946')"><i class="fas fa-copy"></i></button>
                    </div>
                    <div class="info-item">
                        <label>Account Type</label>
                        <strong id="accType">Savings</strong>
                    </div>
                    <div class="info-item">
                        <label>Account Status</label>
                        <strong style="color: #28a745;"><i class="fas fa-check-circle"></i> Active</strong>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <h3 class="section-title"><i class="fas fa-bolt"></i> Quick Actions</h3>
            <div class="quick-actions">
                <div class="action-card" onclick="location.href='transfer.html'">
                    <i class="fas fa-paper-plane"></i>
                    <h4>Send Money</h4>
                </div>
                <div class="action-card" onclick="location.href='pay-bills.html'">
                    <i class="fas fa-file-invoice-dollar"></i>
                    <h4>Pay Bills</h4>
                </div>
                <div class="action-card" onclick="location.href='request-loan.html'">
                    <i class="fas fa-hand-holding-usd"></i>
                    <h4>Request Loan</h4>
                </div>
                <div class="action-card" onclick="location.href='investment.html'">
                    <i class="fas fa-chart-line"></i>
                    <h4>Investments</h4>
                </div>
                <div class="action-card" onclick="location.href='cards.html'">
                    <i class="fas fa-credit-card"></i>
                    <h4>My Cards</h4>
                </div>
                <div class="action-card" onclick="location.href='statements.html'">
                    <i class="fas fa-file-invoice"></i>
                    <h4>Statements</h4>
                </div>
                <div class="action-card" onclick="location.href='settings.html'">
                    <i class="fas fa-cog"></i>
                    <h4>Settings</h4>
                </div>
            </div>
            
            <!-- Recent Transactions -->
            <div class="transactions-card">
                <div class="transactions-header">
                    <h3><i class="fas fa-history"></i> Recent Transactions</h3>
                    <a href="#" class="view-all" onclick="showAllTransactions()">View All</a>
                </div>
                <div id="transactionsList">
                    <div class="no-transactions">
                        <i class="fas fa-receipt"></i>
                        <p>No recent transactions</p>
                    </div>
                </div>
            </div>
            
            <!-- Recent Activity -->
            <div class="activity-card" id="activity">
                <div class="transactions-header">
                    <h3><i class="fas fa-clock"></i> Recent Activity</h3>
                </div>
                <div id="activityList">
                    <div class="activity-item">
                        <div class="activity-dot"></div>
                        <div class="activity-content">
                            <p>Account logged in</p>
                            <span>Just now</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
        const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' 
            ? 'http://localhost:3001' 
            : '';
        let userId = null;
        
        async function loadDashboard() {
            const token = localStorage.getItem('token');
            if (!token) {
                window.location.href = 'signin.html';
                return;
            }
            
            try {
                // Load user profile
                const res = await fetch(`${API_URL}/api/auth/profile`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await res.json();
                
                if (data.success && data.user) {
                    userId = data.user.id;
                    document.getElementById('userName').textContent = data.user.firstName || 'User';
                    document.getElementById('balance').textContent = '$' + (data.user.balance || 0).toLocaleString(undefined, {minimumFractionDigits: 2});
                    document.getElementById('accountNumber').textContent = data.user.accountNumber || '-';
                    document.getElementById('accountType').textContent = (data.user.accountType || 'Savings') + ' Account';
                    document.getElementById('accType').textContent = data.user.accountType || 'Savings';
                    
                    // Calculate savings progress
                    const balance = data.user.balance || 0;
                    const goal = 10000;
                    const progress = Math.min(100, Math.round((balance / goal) * 100));
                    document.getElementById('savingsProgress').textContent = progress + '%';
                    
                    // Load transactions and activity
                    loadTransactions();
                    loadActivity();
                    loadNotifications();
                } else {
                    window.location.href = 'signin.html';
                }
            } catch (e) {
                console.error('Dashboard load error:', e);
            }
        }

        async function loadNotifications() {
            const token = localStorage.getItem('token');
            try {
                const res = await fetch(`${API_URL}/api/notifications?limit=10`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await res.json();
                if (data.success) {
                    document.getElementById('notifBadge').textContent = data.unreadCount || 0;
                }
            } catch (e) {
                // Keep badge as-is on errors
                console.error('Notifications load error:', e);
            }
        }
        
        async function loadTransactions() {
            const token = localStorage.getItem('token');
            if (!userId) return;
            
            try {
                // Avoid cached 304 responses hiding new transactions.
                const res = await fetch(`${API_URL}/api/user/${userId}/transactions?ts=${Date.now()}`, {
                    cache: 'no-store',
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await res.json();

                if (!res.ok || !data?.success) {
                    const msg = data?.message || `Failed to load transactions (HTTP ${res.status})`;
                    displayTransactionsError(msg);
                    return;
                }

                if (Array.isArray(data.transactions)) {
                    displayTransactions(data.transactions.slice(0, 5));
                } else {
                    displayTransactionsError('Transactions response was not in the expected format.');
                }
            } catch (e) {
                console.error('Transactions load error:', e);
                displayTransactionsError('Could not load transactions. Please refresh and try again.');
            }
        }

        function displayTransactionsError(message) {
            const container = document.getElementById('transactionsList');
            container.innerHTML = `
                <div class="no-transactions">
                    <i class="fas fa-exclamation-triangle" style="color:#d9534f;"></i>
                    <p style="color:#d9534f;">${escapeHtml(message)}</p>
                </div>
            `;
        }

        function escapeHtml(value) {
            const s = String(value ?? '');
            return s
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
        }

        function txnTimestamp(tx) {
            return tx?.date || tx?.createdAt || tx?.created_at || tx?.created || tx?.timestamp || null;
        }

        function txnDirectionLabel(tx) {
            const fromId = Number(tx?.fromUserId);
            const toId = Number(tx?.toUserId);
            const me = Number(userId);

            const fromName = [tx?.fromFirstName, tx?.fromLastName].filter(Boolean).join(' ').trim();
            const toName = [tx?.toFirstName, tx?.toLastName].filter(Boolean).join(' ').trim();

            const t = String(tx?.type || '').toLowerCase();
            const incomingTypeLabel = {
                direct_deposit: 'Direct deposit',
                ach: 'ACH credit',
                wire: 'Wire transfer',
                income: 'Income',
                salary: 'Salary payment',
                admin_transfer: 'Incoming transfer'
            };

            if (Number.isFinite(fromId) && Number.isFinite(toId) && Number.isFinite(me)) {
                if (toId === me && fromId !== me) {
                    // Prefer realistic banking labels over "Received from Admin Account".
                    if (incomingTypeLabel[t]) return incomingTypeLabel[t];
                    return fromName ? `Received from ${fromName}` : 'Incoming transfer';
                }
                if (fromId === me && toId !== me) return `Sent to ${toName || 'another account'}`;
            }

            if (t === 'credit' || t === 'deposit') return 'Credit';
            if (t === 'debit' || t === 'withdrawal') return 'Debit';
            if (t) return t.charAt(0).toUpperCase() + t.slice(1);
            return 'Transaction';
        }
        
        function displayTransactions(transactions) {
            const container = document.getElementById('transactionsList');
            
            if (!transactions || transactions.length === 0) {
                container.innerHTML = `
                    <div class="no-transactions">
                        <i class="fas fa-receipt"></i>
                        <p>No recent transactions</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = transactions.map(tx => {
                const me = Number(userId);
                const fromId = Number(tx?.fromUserId);
                const toId = Number(tx?.toUserId);

                // Prefer direction-based credit/debit for transfers.
                let isCredit = false;
                if (Number.isFinite(me) && Number.isFinite(toId) && toId === me) {
                    isCredit = true;
                } else if (Number.isFinite(me) && Number.isFinite(fromId) && fromId === me) {
                    isCredit = false;
                } else {
                    const t = String(tx?.type || '').toLowerCase();
                    isCredit = (t === 'credit' || t === 'deposit' || t === 'received' || t === 'transfer_in');
                }
                const icon = isCredit ? 'fa-arrow-down' : 'fa-arrow-up';
                const amountClass = isCredit ? 'credit' : 'debit';
                const amountPrefix = isCredit ? '+' : '-';

                const ts = txnTimestamp(tx);
                const d = ts ? new Date(ts) : null;
                const date = d && !isNaN(d.getTime())
                    ? d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })
                    : '-';

                const subtitle = txnDirectionLabel(tx);
                const title = tx.description ? String(tx.description) : subtitle;
                
                return `
                    <div class="transaction-item">
                        <div class="transaction-icon ${amountClass}">
                            <i class="fas ${icon}"></i>
                        </div>
                        <div class="transaction-details">
                            <h4>${escapeHtml(title)}</h4>
                            <span>${escapeHtml(subtitle)} â€¢ ${escapeHtml(date)}</span>
                        </div>
                        <div class="transaction-amount ${amountClass}">
                            ${amountPrefix}$${Math.abs(tx.amount).toLocaleString(undefined, {minimumFractionDigits: 2})}
                        </div>
                        <button class="btn-receipt" onclick="downloadReceipt(${tx.id})" title="Download Receipt">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                `;
            }).join('');
        }
        
        async function downloadReceipt(transactionId) {
            const token = localStorage.getItem('token');
            try {
                const response = await fetch(`${API_URL}/api/transactions/${transactionId}/receipt`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `receipt_${transactionId}.pdf`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                } else {
                    alert('Error downloading receipt');
                }
            } catch (err) {
                console.error('Receipt download error:', err);
                alert('Error downloading receipt');
            }
        }
        
        async function loadActivity() {
            const token = localStorage.getItem('token');
            if (!userId) return;
            
            try {
                const res = await fetch(`${API_URL}/api/user/${userId}/activity`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await res.json();
                
                if (data.success && data.activities && data.activities.length > 0) {
                    displayActivity(data.activities.slice(0, 5));
                }
            } catch (e) {
                console.error('Activity load error:', e);
            }
        }
        
        function displayActivity(activities) {
            const container = document.getElementById('activityList');
            
            container.innerHTML = activities.map(activity => {
                const date = new Date(activity.timestamp || activity.createdAt);
                const timeAgo = getTimeAgo(date);
                
                return `
                    <div class="activity-item">
                        <div class="activity-dot"></div>
                        <div class="activity-content">
                            <p>${activity.action || activity.description}</p>
                            <span>${timeAgo}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function getTimeAgo(date) {
            const now = new Date();
            const diff = Math.floor((now - date) / 1000);
            
            if (diff < 60) return 'Just now';
            if (diff < 3600) return Math.floor(diff / 60) + ' minutes ago';
            if (diff < 86400) return Math.floor(diff / 3600) + ' hours ago';
            if (diff < 604800) return Math.floor(diff / 86400) + ' days ago';
            
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }
        
        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            copyText(text);
        }
        
        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }
        
        function showAllTransactions() {
            location.href = 'transactions.html';
        }
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }
        
        function logout() {
            localStorage.clear();
            window.location.href = 'signin.html';
        }
        
        // Initialize
        loadDashboard();
    </script>
</body>
</html>